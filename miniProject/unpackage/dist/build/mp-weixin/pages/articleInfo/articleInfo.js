"use strict";const e=require("../../common/vendor.js"),o=require("../../uni_modules/wot-design-uni/components/wd-toast/index.js"),n=require("../../uni_modules/wot-design-uni/components/common/dayjs.js");require("../../uni_modules/wot-design-uni/locale/index.js");const l=require("../../api/articleApi.js"),i=require("../../api/commentApi.js"),t=require("../../utils/userStorage.js");if(!Array){(e.resolveComponent("wd-img")+e.resolveComponent("wd-icon")+e.resolveComponent("wd-divider")+e.resolveComponent("wd-status-tip")+e.resolveComponent("wd-gap")+e.resolveComponent("wd-input")+e.resolveComponent("wd-button")+e.resolveComponent("wd-toast"))()}Math||((()=>"../../uni_modules/wot-design-uni/components/wd-img/wd-img.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-icon/wd-icon.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-divider/wd-divider.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-status-tip/wd-status-tip.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-gap/wd-gap.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-input/wd-input.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-button/wd-button.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-toast/wd-toast.js"))();const s=e.defineComponent({__name:"articleInfo",setup(s){const u=e.ref(),a=e.ref(),d=e.ref(),r=e.ref("写下你的想法"),c=e.ref(),v=o.useToast(),m=e.ref(),g=e.ref(0),p=e.ref();e.onLoad((e=>{console.log("接收到的数据：",null==e?void 0:e.articleId),u.value=null==e?void 0:e.articleId,w(),f(),p.value=t.getUserInfo()}));const w=async()=>{console.log("获取文章详情");const e=await l.getArticleByArticleId(u.value);200==e.code?(console.log(e),c.value=e.data,a.value=c.value.userVO):v.show(e.message)},h=e=>{switch(e){case 1:return"one-column";case 2:case 4:return"two-columns";default:return"three-columns"}},f=async()=>{const e=await i.getCommentListByArticleId(u.value);200==e.code?(console.log(e),d.value=e.data):v.show(e.message)},j=e=>{console.log(e.userVO.userName),r.value="回复@"+e.userVO.userName+"：",console.log(e),g.value=e.id},x=async()=>{const e={articleId:u.value,content:m.value,userId:p.value.id,parentId:g.value};console.log("发布评论",e);const o=await i.addComment(e);200==o.code?(v.show("评论成功"),m.value="",g.value=0,f()):v.show(o.message)},_=()=>{e.index.showModal({title:"提示",content:"确定删除该文章吗？",success:async function(o){if(o.confirm){const o=await l.deleteArticle(u.value);200==o.code?(v.show("删除成功"),setTimeout((()=>{const o=getCurrentPages().find((e=>"pages/index/index"===e.route));o&&o.$vm.setNeedRefresh(),e.index.switchTab({url:"/pages/index/index"})}),1e3)):v.show(o.message)}}})};e.onShareAppMessage((e=>(console.log(e),{title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),e.onShareTimeline((()=>({title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"})));return(o,l)=>{var i,t,s,u,v,g,w,f,I,b,y,C,L,q,A,V,N,O,T,U,M,z,F,H,S,k;return e.e({a:e.p({width:60,height:60,src:null==(i=a.value)?void 0:i.imageUrl,round:!0}),b:(null==(t=p.value)?void 0:t.id)==(null==(s=c.value)?void 0:s.userId)},(null==(u=p.value)||u.id,null==(v=c.value)||v.userId,{}),{c:e.t(null==(g=a.value)?void 0:g.userName),d:e.t(e.unref(n.dayjs)(null==(w=c.value)?void 0:w.createTime).format("MM月DD日 HH:mm")),e:(k=null==(f=c.value)?void 0:f.content,k?k.split("\n").map((e=>`<div class="content-paragraph">${e}</div>`)).join(""):""),f:null==(b=null==(I=c.value)?void 0:I.imagesList)?void 0:b.length},(null==(C=null==(y=c.value)?void 0:y.imagesList)?void 0:C.length)?{g:e.f(null==(L=c.value)?void 0:L.imagesList,((o,n,l)=>e.e({a:"23832403-1-"+l,b:e.p({width:"100%",height:"100%",mode:"aspectFill","show-menu-by-longpress":!0,radius:"12px",src:o}),c:0===n&&c.value.imagesList.length>1},0===n&&c.value.imagesList.length>1?{d:"23832403-2-"+l,e:e.p({name:"picture",size:"14px",color:"#fff"}),f:e.t(c.value.imagesList.length)}:{},{g:n,h:e.o((n=>((o,n)=>{console.log(n),e.index.previewImage({current:o,urls:n})})(o,c.value.imagesList)),n)}))),h:e.n(h(null==(q=c.value)?void 0:q.imagesList.length))}:{},{i:(null==(A=p.value)?void 0:A.id)==(null==(V=c.value)?void 0:V.userId)},(null==(N=p.value)?void 0:N.id)==(null==(O=c.value)?void 0:O.userId)?e.e({j:(null==(T=p.value)?void 0:T.id)==(null==(U=c.value)?void 0:U.userId)},(null==(M=p.value)?void 0:M.id)==(null==(z=c.value)?void 0:z.userId)?{k:e.p({name:"delete",size:"16px",color:"#FF5252"}),l:e.o(_)}:{}):{},{m:e.t((null==(F=c.value)?void 0:F.commentCount)||0),n:null==(H=d.value)?void 0:H.length},(null==(S=d.value)?void 0:S.length)?{o:e.f(d.value,((o,n,l)=>{var i,t,s;return e.e({a:"23832403-5-"+l,b:e.p({width:50,height:50,src:o.userVO.imageUrl,round:!0}),c:e.t(null==(i=o.userVO)?void 0:i.userName),d:e.t(o.createTime),e:e.t(o.content),f:e.o((e=>j(o)),o.id),g:null==(t=o.replies)?void 0:t.length},(null==(s=o.replies)?void 0:s.length)?{h:e.f(o.replies,((o,n,l)=>{var i,t;return{a:e.t(null==(i=o.userVO)?void 0:i.userName),b:e.t(null==(t=o.parentUserVO)?void 0:t.userName),c:e.t(o.content),d:e.o((e=>j(o)),o.id),e:e.t(o.createTime),f:o.id}}))}:{},{i:o.id})}))}:{p:e.p({image:"content",tip:"暂无评论"})},{q:e.p({"safe-area-bottom":!0,height:"120"}),r:e.o(x),s:e.o((e=>m.value=e)),t:e.p({placeholder:r.value,clearable:!0,"no-border":!0,"prefix-icon":"edit-1","placeholder-style":"color: #999;",modelValue:m.value}),v:e.o(x),w:e.p({type:"primary",size:"small",disabled:!m.value})})}}});s.__runtimeHooks=6;const u=e._export_sfc(s,[["__scopeId","data-v-23832403"]]);wx.createPage(u);
