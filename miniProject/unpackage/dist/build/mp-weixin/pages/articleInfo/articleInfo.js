"use strict";const e=require("../../common/vendor.js"),o=require("../../uni_modules/wot-design-uni/components/wd-toast/index.js"),n=require("../../uni_modules/wot-design-uni/components/common/dayjs.js");require("../../uni_modules/wot-design-uni/locale/index.js");const t=require("../../api/articleApi.js"),s=require("../../api/commentApi.js"),i=require("../../utils/userStorage.js");if(!Array){(e.resolveComponent("wd-img")+e.resolveComponent("wd-text")+e.resolveComponent("wd-icon")+e.resolveComponent("wd-divider")+e.resolveComponent("wd-status-tip")+e.resolveComponent("wd-gap")+e.resolveComponent("wd-input")+e.resolveComponent("wd-button")+e.resolveComponent("wd-toast"))()}Math||((()=>"../../uni_modules/wot-design-uni/components/wd-img/wd-img.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-text/wd-text.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-icon/wd-icon.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-divider/wd-divider.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-status-tip/wd-status-tip.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-gap/wd-gap.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-input/wd-input.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-button/wd-button.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-toast/wd-toast.js"))();const l=e.defineComponent({__name:"articleInfo",setup(l){const u=e.ref(),a=e.ref(),d=e.ref(),r=e.ref("写下你的想法"),c=e.ref(),m=o.useToast(),p=e.ref(),v=e.ref(0),g=e.ref();e.onLoad((e=>{console.log("接收到的数据：",e.articleId),u.value=e.articleId,w(),f(),g.value=i.getUserInfo()}));const w=async()=>{console.log("获取文章详情");const e=await t.getArticleByArticleId(u.value);200==e.code?(console.log(e),c.value=e.data,a.value=c.value.userVO):m.show(e.message)},h=e=>{switch(e){case 1:return"one-column";case 2:case 4:return"two-columns";default:return"three-columns"}},f=async()=>{const e=await s.getCommentListByArticleId(u.value);200==e.code?(console.log(e),d.value=e.data):m.show(e.message)},x=e=>{console.log(e.userVO.userName),r.value="回复@"+e.userVO.userName+"：",console.log(e),v.value=e.id},j=async()=>{const e={articleId:u.value,content:p.value,userId:g.value.id,parentId:v.value};console.log("发布评论",e);const o=await s.addComment(e);200==o.code?(m.show("评论成功"),p.value="",v.value=0,f()):m.show(o.message)},_=()=>{e.index.showModal({title:"提示",content:"确定删除该文章吗？",success:async function(o){if(o.confirm){const o=await t.deleteArticle(u.value);200==o.code?(m.show("删除成功"),setTimeout((()=>{const o=getCurrentPages().find((e=>"pages/index/index"===e.route));o&&o.$vm.setNeedRefresh(),e.index.switchTab({url:"/pages/index/index"})}),1e3)):m.show(o.message)}}})};return e.onShareAppMessage((e=>(console.log(e),{title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),e.onShareTimeline((()=>({title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),(o,t)=>{var s,i,l,u,m,v,w,f,b,C,y,I,A,q,V;return e.e({a:e.p({width:40,height:40,src:null==(s=a.value)?void 0:s.imageUrl,radius:"5"}),b:e.t(null==(i=a.value)?void 0:i.userName),c:e.p({size:"16px",color:"#5e5e5e",text:null==(l=c.value)?void 0:l.content}),d:null!=(null==(u=c.value)?void 0:u.imagesList)},null!=(null==(m=c.value)?void 0:m.imagesList)?{e:e.f(null==(v=c.value)?void 0:v.imagesList,((o,n,t)=>({a:e.o((n=>((o,n)=>{console.log(n),e.index.previewImage({current:o,urls:n})})(o,c.value.imagesList)),n),b:"72df3b75-2-"+t,c:e.p({width:"100%",height:"100%",mode:"aspectFill","show-menu-by-longpress":!0,radius:"5px",src:o}),d:n}))),f:e.n(h(null==(w=c.value)?void 0:w.imagesList.length))}:{},{g:e.p({size:"12px",text:e.unref(n.dayjs)(null==(f=c.value)?void 0:f.createTime).format("YYYY年MM月DD日HH:mm")}),h:(null==(b=g.value)?void 0:b.id)==(null==(C=c.value)?void 0:C.userId)},(null==(y=g.value)?void 0:y.id)==(null==(I=c.value)?void 0:I.userId)?{i:e.o(_),j:e.p({name:"delete",size:"14px",color:"#5A6C8F"})}:{},{k:e.p({text:"评论("+(null==(A=c.value)?void 0:A.commentCount)+")"}),l:0!=(null==(q=d.value)?void 0:q.length)},0!=(null==(V=d.value)?void 0:V.length)?{m:e.f(d.value,((o,n,t)=>{var s;return{a:"72df3b75-7-"+t,b:e.p({width:40,height:40,src:o.userVO.imageUrl,round:!0}),c:e.t(null==(s=o.userVO)?void 0:s.userName),d:"72df3b75-8-"+t,e:e.p({text:o.createTime,size:"12px"}),f:e.t(o.content),g:e.o((e=>x(o)),o.id),h:e.f(o.replies,((o,n,s)=>{var i,l;return{a:e.t(null==(i=o.userVO)?void 0:i.userName),b:"72df3b75-9-"+t+"-"+s,c:e.t(null==(l=o.parentUserVO)?void 0:l.userName),d:e.t(o.content),e:e.o((e=>x(o)),o.id),f:"72df3b75-10-"+t+"-"+s,g:e.p({text:o.createTime,size:"12px"}),h:o.id}})),i:o.id}})),n:e.p({text:"回复"})}:{o:e.p({image:"content",tip:"暂无评论"})},{p:e.p({"safe-area-bottom":!0,height:"60"}),q:e.o(j),r:e.o((e=>p.value=e)),s:e.p({placeholder:r.value,clearable:!0,"no-border":!0,"prefix-icon":"edit-1","placeholder-style":"color: #999;",modelValue:p.value}),t:e.o(j),v:e.p({type:"primary",size:"small",disabled:!p.value})})}}});l.__runtimeHooks=6;const u=e._export_sfc(l,[["__scopeId","data-v-72df3b75"]]);wx.createPage(u);
