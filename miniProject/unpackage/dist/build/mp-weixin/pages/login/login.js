"use strict";const e=require("../../common/vendor.js"),o=require("../../uni_modules/wot-design-uni/components/wd-toast/index.js");require("../../uni_modules/wot-design-uni/locale/index.js");const n=require("../../api/userApi.js"),s=require("../../utils/userStorage.js");if(!Array){(e.resolveComponent("wd-navbar")+e.resolveComponent("wd-button")+e.resolveComponent("wd-toast"))()}Math||((()=>"../../uni_modules/wot-design-uni/components/wd-navbar/wd-navbar.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-button/wd-button.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-toast/wd-toast.js"))();const t=e.defineComponent({__name:"login",setup(t){const a=o.useToast(),i=async o=>{e.index.showLoading({title:"加载中"});const t=o.code,i=await n.wxLogin(t);200==i.code?(console.log(i.data),e.index.setStorageSync("token",i.data.token),s.setUserInfo(i.data),a.success("登录成功"),setTimeout((()=>{e.index.switchTab({url:"/pages/index/index"})}),1e3)):console.log(i),e.index.hideLoading(),a.error(i.msg)};e.onLoad((()=>{s.clearUserInfo()}));const d=()=>{e.index.navigateBack()};return(o,n)=>({a:e.o(d),b:e.p({"custom-class":"navbar",bordered:!1,title:"登陆",safeAreaInsetTop:!0,"left-arrow":!0}),c:e.o(i),d:e.p({icon:"app",type:"success",block:!0,"open-type":"getPhoneNumber"})})}}),a=e._export_sfc(t,[["__scopeId","data-v-c4d13e37"]]);wx.createPage(a);
