"use strict";const e=require("../../common/vendor.js"),i=require("../../api/articleApi.js"),o=require("../../utils/userStorage.js"),t=require("../../uni_modules/wot-design-uni/components/wd-toast/index.js");require("../../uni_modules/wot-design-uni/locale/index.js");const n=require("../../utils/activityEnum.js"),s=require("../../api/activityApi.js");if(!Array){(e.resolveComponent("wd-img")+e.resolveComponent("wd-tag")+e.resolveComponent("wd-icon")+e.resolveComponent("wd-cell")+e.resolveComponent("wd-cell-group")+e.resolveComponent("wd-popup")+e.resolveComponent("wd-segmented")+e.resolveComponent("wd-text")+e.resolveComponent("wd-loading")+e.resolveComponent("wd-popover")+e.resolveComponent("wd-loadmore")+e.resolveComponent("wd-toast"))()}Math||((()=>"../../uni_modules/wot-design-uni/components/wd-img/wd-img.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-tag/wd-tag.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-icon/wd-icon.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-cell/wd-cell.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-cell-group/wd-cell-group.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-popup/wd-popup.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-segmented/wd-segmented.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-text/wd-text.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-loading/wd-loading.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-popover/wd-popover.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-loadmore/wd-loadmore.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-toast/wd-toast.js"))();const a=e.defineComponent({__name:"my",setup(a){const l=e.ref({}),r=t.useToast(),u=e.ref([]),d=e.ref([]),g=e.ref("loading"),c=e.reactive({current:1,pageSize:5,total:0,userId:null,hasMore:!0,isRefreshing:!1}),p=e.reactive({current:1,pageSize:5,hasMore:!0,isRefreshing:!1}),v=e.ref(["投稿","活动","收藏","喜欢"]),m=e.ref("投稿");e.ref(!1);const h=e.ref([]),f=e.reactive({current:1,pageSize:5,hasMore:!0,isRefreshing:!1}),w=e.ref([]),b=e.reactive({current:1,pageSize:5,hasMore:!0,isRefreshing:!1}),x=e=>{switch(e){case 1:return"one-column";case 2:case 4:return"two-columns";default:return"three-columns"}},L=i=>{e.index.navigateTo({url:`/pages/articleInfo/articleInfo?articleId=${i}`})},y=()=>{console.log("加载......"),g.value="loading",j()},R=()=>{e.index.navigateTo({url:"/pages/updateUserInfo/updateUserInfo"})},j=async(o=!1)=>{if(!c.isRefreshing){c.isRefreshing=!0;try{if(o&&(c.current=1,c.hasMore=!0,u.value=[],e.index.showNavigationBarLoading()),!c.hasMore)return void(g.value="finished");const t=await i.getArticleList({current:c.current,pageSize:c.pageSize,userId:c.userId});200===t.code&&(u.value=o?t.data.records:[...u.value,...t.data.records],c.total=t.data.total,c.hasMore=c.current*c.pageSize<t.data.total,c.current+=1,g.value=c.hasMore?"loading":"finished")}catch(t){console.error("加载失败:",t),g.value="error"}finally{c.isRefreshing=!1,e.index.hideNavigationBarLoading(),e.index.stopPullDownRefresh()}}},k=async(i=!1)=>{if(!p.isRefreshing){p.isRefreshing=!0;try{if(i&&(p.current=1,p.hasMore=!0,d.value=[],e.index.showNavigationBarLoading()),!p.hasMore)return void(g.value="finished");const o=await s.getActivityVOByJoinUserId(l.value.id);200===o.code?(d.value=i?o.data:[...d.value,...o.data],p.hasMore=!1,g.value="finished"):r.error(o.message)}catch(o){console.error("获取活动列表失败:",o),g.value="error"}finally{p.isRefreshing=!1,e.index.hideNavigationBarLoading(),e.index.stopPullDownRefresh()}}},M=async(i=!1)=>{var o;if(!f.isRefreshing){f.isRefreshing=!0;try{if(i&&(f.current=1,f.hasMore=!0,h.value=[],e.index.showNavigationBarLoading()),!f.hasMore)return void(g.value="finished");console.log("获取收藏列表:",{current:f.current,pageSize:f.pageSize,userId:null==(o=l.value)?void 0:o.id}),g.value="finished"}catch(t){console.error("获取收藏列表失败:",t),g.value="error"}finally{f.isRefreshing=!1,e.index.hideNavigationBarLoading(),e.index.stopPullDownRefresh()}}},_=async(o=!1)=>{var t;if(!b.isRefreshing){b.isRefreshing=!0;try{if(o&&(b.current=1,b.hasMore=!0,w.value=[],e.index.showNavigationBarLoading()),!b.hasMore)return void(g.value="finished");const n=await i.getArticleVOLikeListByUserId(null==(t=l.value)?void 0:t.id);console.log(n),200==n.code?w.value=n.data:r.error(n.msg),g.value="finished"}catch(n){console.error("获取点赞列表失败:",n),g.value="error"}finally{b.isRefreshing=!1,e.index.hideNavigationBarLoading(),e.index.stopPullDownRefresh()}}};e.onReachBottom((()=>{"投稿"===m.value?c.hasMore&&!c.isRefreshing&&j():"活动"===m.value?p.hasMore&&!p.isRefreshing&&k():"收藏"===m.value?f.hasMore&&!f.isRefreshing&&M():"喜欢"===m.value&&b.hasMore&&!b.isRefreshing&&_()})),e.onPullDownRefresh((()=>{"投稿"===m.value?j(!0):"活动"===m.value?k(!0):"收藏"===m.value?M(!0):"喜欢"===m.value&&_(!0)})),e.watch((()=>m.value),(e=>{g.value="loading","投稿"===e?j(!0):"活动"===e?k(!0):"收藏"===e?M(!0):"喜欢"===e&&_(!0)})),e.onShow((()=>{const e=o.getUserInfo();e&&(l.value=e,c.userId=e.id),"投稿"===m.value?j(!0):"活动"===m.value?k(!0):"收藏"===m.value?M(!0):"喜欢"===m.value&&_(!0)}));const I=e.ref(!1),C=()=>{I.value=!1},z=()=>{I.value=!0};return e.onShareAppMessage((e=>(console.log(e),{title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),e.onShareTimeline((()=>({title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),(i,o)=>{var t;return e.e({a:e.p({src:l.value.imageUrl,width:"80",height:"80",round:!0}),b:e.t(l.value.userName),c:e.t((null==(t=l.value)?void 0:t.constellation)||"修仙熬夜座~"),d:e.o(R),e:e.t(l.value.userProfile||"这个人很懒，简介都不想写，估计是没有对象吧"),f:e.f(l.value.tagList,((i,o,t)=>({a:e.t(i),b:o,c:"88618b3b-1-"+t,d:e.p({type:1==o?"primary":2==o?"warning":"success",round:!0})}))),g:e.t(l.value.follows||0),h:e.t(l.value.fans||0),i:e.t(l.value.likes||0),j:e.p({name:"view-list",size:"20px",color:"#adadad"}),k:e.o(z),l:e.p({title:"修改个人信息","title-width":"150px",icon:"edit-outline","is-link":!0,to:"/pages/updateUserInfo/updateUserInfo"}),m:e.p({title:"反馈中心","title-width":"150px",icon:"cloud-upload","is-link":!0,to:"/pages/feedback/feedback"}),n:e.p({title:"联系我们","title-width":"150px",icon:"call","is-link":!0,to:"/pages/relation/relation"}),o:e.p({border:!0}),p:e.o(C),q:e.o((e=>I.value=e)),r:e.p({position:"left","custom-style":"height:100vh;width:70%",modelValue:I.value}),s:e.o((e=>m.value=e)),t:e.p({options:v.value,value:m.value}),v:"投稿"===m.value},"投稿"===m.value?{w:e.f(u.value,((i,o,t)=>e.e({a:e.t(i.createTime.split("T")[0]),b:e.t(i.content),c:0!=i.imagesList.length},0!=i.imagesList.length?{d:e.f(i.imagesList.slice(0,3),((o,n,s)=>e.e({a:"88618b3b-9-"+t+"-"+s,b:e.p({width:"100%",height:"100%",mode:"aspectFill",radius:"5px",src:o}),c:2===n&&i.imagesList.length>3},2===n&&i.imagesList.length>3?{d:e.t(i.imagesList.length-3)}:{},{e:n,f:2===n?1:""}))),e:1===i.imagesList.length?1:""}:{},{f:e.f(i.tags,((i,o,n)=>({a:e.t(i),b:i,c:"88618b3b-10-"+t+"-"+n}))),g:"88618b3b-11-"+t,h:e.t(i.viewCount),i:i.isLike},i.isLike?{j:"88618b3b-12-"+t,k:e.p({"class-prefix":"t-icon",name:"like-selected"})}:{l:"88618b3b-13-"+t,m:e.p({"class-prefix":"t-icon",name:"like"})},{n:e.t(i.likeCount),o:"88618b3b-14-"+t,p:e.t(i.commentCount),q:o}))),x:l.value.imageUrl,y:e.t(l.value.userName),z:e.p({type:"primary",plain:!0,mark:!0}),A:e.p({name:"view",size:"16px"}),B:e.p({name:"chat",size:"16px"})}:{},{C:"活动"===m.value},"活动"===m.value?{D:e.f(d.value,((i,o,t)=>({a:i.coverPicture,b:e.t(e.unref(n.getActivityStatus)(null==i?void 0:i.status)),c:e.t(i.title),d:"88618b3b-15-"+t,e:e.t(i.endTime),f:"88618b3b-16-"+t,g:e.t(i.position),h:o,i:e.o((i=>(i=>{console.log("点击活动详情");const o=JSON.stringify(d.value[i]);e.index.navigateTo({url:"/pages/activityDetail/activityDetail?activityInfo="+o})})(o)),o)}))),E:e.p({name:"time"}),F:e.p({name:"location"})}:{},{G:"收藏"===m.value},"收藏"===m.value?e.e({H:0===h.value.length},(h.value.length,{})):{},{I:"喜欢"===m.value},"喜欢"===m.value?e.e({J:0===w.value.length},(w.value.length,{}),{K:e.f(w.value,((o,t,n)=>e.e({a:"88618b3b-17-"+n,b:e.p({src:o.userVO.imageUrl,width:45,height:45,round:!0,mode:"scaleToFill"}),c:e.t(o.userVO.userName),d:e.t(o.createTime),e:e.o((i=>{return t=o.userVO.id,console.log("id",t),void e.index.navigateTo({url:`/pages/userDetail/userDetail?userId=${t}`});var t}),t),f:"88618b3b-18-"+n,g:e.p({text:o.content,color:"#565756",size:"14px",lines:4}),h:e.o((e=>L(o.id)),t),i:null!=o.imagesList},null!=o.imagesList?{j:e.f(o.imagesList.slice(0,9),((t,s,a)=>e.e({a:"88618b3b-20-"+n+"-"+a+",88618b3b-19-"+n+"-"+a,b:e.o((e=>i.previewImage(t,o.imagesList)),s),c:"88618b3b-19-"+n+"-"+a,d:e.p({width:"100%",height:"100%",mode:"aspectFill","show-menu-by-longpress":!0,radius:"5px",src:t}),e:8===s&&o.imagesList.length>9},8===s&&o.imagesList.length>9?{f:e.t(o.imagesList.length-9)}:{},{g:s}))),k:e.o((e=>L(o.id)),t),l:e.n(x(o.imagesList.length))}:{},{m:"88618b3b-21-"+n,n:e.t(o.viewCount),o:o.isLike},(o.isLike,{}),{p:e.t(o.likeCount),q:e.o((e=>i.handleLikeItem(o.id,t)),t),r:"88618b3b-22-"+n,s:e.t(o.commentCount),t:e.o((e=>L(o.id)),t),v:"88618b3b-24-"+n+",88618b3b-23-"+n,w:e.o((e=>i.link(o.id)),t),x:"88618b3b-23-"+n,y:e.o(((...e)=>i.closeOutside&&i.closeOutside(...e)),t),z:t}))),L:e.p({name:"view",size:"16px"}),M:e.p({name:"chat",size:"16px"}),N:e.p({name:"more",size:"16px"}),O:e.p({mode:"menu",content:i.menu})}):{},{P:e.o(y),Q:e.p({"custom-class":"loadmore",state:g.value,"loading-text":"别急在跑了...","finished-text":"已经没有啦~","error-text":"与火星断联了~，点击重试"})})}}});a.__runtimeHooks=6;const l=e._export_sfc(a,[["__scopeId","data-v-88618b3b"]]);wx.createPage(l);
