"use strict";const e=require("../../common/vendor.js"),l=require("../../utils/userStorage.js"),a=require("../../api/userApi.js"),o=require("../../uni_modules/wot-design-uni/components/wd-toast/index.js");require("../../uni_modules/wot-design-uni/locale/index.js");const s=require("../../api/uploadApi.js");if(!Array){(e.resolveComponent("wd-navbar")+e.resolveComponent("wd-img")+e.resolveComponent("wd-button")+e.resolveComponent("wd-input")+e.resolveComponent("wd-cell")+e.resolveComponent("wd-select-picker")+e.resolveComponent("wd-textarea")+e.resolveComponent("wd-gap")+e.resolveComponent("wd-toast"))()}Math||((()=>"../../uni_modules/wot-design-uni/components/wd-navbar/wd-navbar.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-img/wd-img.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-button/wd-button.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-input/wd-input.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-cell/wd-cell.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-select-picker/wd-select-picker.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-textarea/wd-textarea.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-gap/wd-gap.js")+(()=>"../../uni_modules/wot-design-uni/components/wd-toast/wd-toast.js"))();const t=e.defineComponent({__name:"updateUserInfo",setup(t){const n=o.useToast(),u=e.ref({tagList:[]}),i=e.ref(""),r=e.ref([{value:0,label:"男"},{value:1,label:"女"},{value:2,label:"保密"}]),d=e.ref([{value:"熬夜冠军座",label:"熬夜冠军座"},{value:"秃然焦虑座",label:"秃然焦虑座"},{value:"奶茶续命座",label:"奶茶续命座"},{value:"地铁迷路座",label:"地铁迷路座"},{value:"社畜进化座",label:"社畜进化座"},{value:"通宵赶工座",label:"通宵赶工座"},{value:"表情包王座",label:"表情包王座"},{value:"社恐晚期座",label:"社恐晚期座"},{value:"香菜毁灭座",label:"香菜毁灭座"},{value:"锦鲤附体座",label:"锦鲤附体座"},{value:"电量焦虑座",label:"电量焦虑座"}]),v=e.ref([{value:"运动达人",label:"运动达人"},{value:"学习狂魔",label:"学习狂魔"},{value:"社交达人",label:"社交达人"},{value:"文艺青年",label:"文艺青年"},{value:"技术宅",label:"技术宅"},{value:"美食家",label:"美食家"},{value:"旅行者",label:"旅行者"},{value:"音乐控",label:"音乐控"},{value:"电影迷",label:"电影迷"},{value:"摄影师",label:"摄影师"},{value:"创意咖",label:"创意咖"},{value:"志愿者",label:"志愿者"}]);e.onLoad((()=>{u.value=l.getUserInfo(),console.log(u.value)}));const c=()=>{e.index.navigateBack()},p=e=>{u.value.constellation=e.value,console.log(u.value),console.log(e)},m=async()=>{console.log(u.value);const o={id:u.value.id,imageUrl:u.value.imageUrl,userName:u.value.userName,userProfile:u.value.userProfile,gender:u.value.gender,constellation:u.value.constellation,tagList:u.value.tagList};if(i.value){200===(await s.deleteFile(i.value)).code?console.log("删除旧图片成功"):console.log("删除旧图片失败")}const t=await a.updateWxUser(o);200===t.code?(n.show("更新成功"),u.value={...t.data,...u.value},l.clearUserInfo(),console.log("user-value:",u.value),l.setUserInfo(u.value),console.log("getuserinfo",l.getUserInfo()),setTimeout((()=>{e.index.navigateBack()}),1e3)):n.show(t.message)},g=l=>{console.log(l);const a=l.avatarUrl;e.index.uploadFile({url:"https://campus.fybreeze.cn/api/article/uploadImages",filePath:a,name:"file",formData:{user:"test"},success(e){i.value=u.value.imageUrl;const l=JSON.parse(e.data);u.value.imageUrl=l.data[0],n.show("上传成功")},fail(e){n.error("上传失败")}})},w=e=>{console.log(e)};return e.onShareAppMessage((e=>(console.log(e),{title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),e.onShareTimeline((()=>({title:"青春共享站",path:"/pages/index/index",imageUrl:"/static/logo.jpg"}))),(l,a)=>{var o;return{a:e.o(c),b:e.p({"custom-class":"navbar",bordered:!1,title:"修改信息",safeAreaInsetTop:!0,"left-arrow":!0}),c:e.p({width:100,height:100,round:!0,src:null==(o=u.value)?void 0:o.imageUrl}),d:e.o(g),e:e.p({"custom-class":"userAvatar",type:"text","open-type":"chooseAvatar"}),f:e.o(w),g:e.o((e=>u.value.userName=e)),h:e.p({type:"nickname","no-border":!0,placeholder:"请输入用户名",modelValue:u.value.userName}),i:e.p({title:"昵称",center:!0}),j:e.o(p),k:e.o((e=>u.value.gender=e)),l:e.p({type:"radio",label:"性别",columns:r.value,modelValue:u.value.gender}),m:e.o(p),n:e.o((e=>u.value.constellation=e)),o:e.p({type:"radio",label:"星座",columns:d.value,modelValue:u.value.constellation}),p:e.o((e=>u.value.tagList=e)),q:e.p({label:"标签",prop:"tagList",type:"checkbox",max:3,columns:v.value,placeholder:"请选择个性标签",modelValue:u.value.tagList}),r:e.o((e=>u.value.userProfile=e)),s:e.p({label:"简介",clearable:!0,placeholder:"请输入简介","show-word-limit":!0,maxlength:100,modelValue:u.value.userProfile}),t:e.o(m),v:e.p({"custom-class":"btn",block:!0,type:"primary"}),w:e.p({height:"60rpx"})}}}});t.__runtimeHooks=6;const n=e._export_sfc(t,[["__scopeId","data-v-457b9883"]]);wx.createPage(n);
