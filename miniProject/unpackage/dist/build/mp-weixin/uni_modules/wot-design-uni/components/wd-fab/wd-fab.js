"use strict";const e=require("../../../../common/vendor.js"),t=require("../common/util.js"),a=require("../composables/useQueue.js"),o=require("../common/clickoutside.js"),i=require("./types.js"),n=require("../composables/useRaf.js");Math||(u+s+c)();const s=()=>"../wd-button/wd-button.js",u=()=>"../wd-icon/wd-icon.js",c=()=>"../wd-transition/wd-transition.js",l=e.defineComponent({name:"wd-fab",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:i.fabProps,emits:["update:active","click"],setup(i,{expose:s,emit:u}){const c=i,l=u,r=e.ref(!1),d=e.ref(!1),v=e.inject(a.queueKey,null),{proxy:m}=e.getCurrentInstance();e.watch((()=>c.active),(e=>{d.value=e}),{immediate:!0,deep:!0}),e.watch((()=>d.value),(e=>{e&&(v&&v.closeOther?v.closeOther(m):o.closeOther(m))}));const f=e.ref(c.direction);e.watch((()=>c.direction),(e=>f.value=e)),e.watch((()=>c.position),(()=>x()));const p=e.ref(0),h=e.ref(0),w=e.reactive({width:0,height:0}),g=e.reactive({width:56,height:56}),b=e.reactive({minTop:0,minLeft:0,maxTop:0,maxLeft:0});function x(){const e=c.position,{minLeft:t,minTop:a,maxLeft:o,maxTop:i}=b;"left-top"===e?(p.value=a,h.value=t):"right-top"===e?(p.value=a,h.value=o):"left-bottom"===e?(p.value=i,h.value=t):"right-bottom"===e&&(p.value=i,h.value=o)}const _=e.reactive({x:0,y:0}),y=e.ref(!1);function T(e){if(!1===c.draggable)return;const t=e.touches[0];_.x=t.clientX-h.value,_.y=t.clientY-p.value,y.value=!1}function j(e){if(!1===c.draggable)return;const t=e.touches[0],{minLeft:a,minTop:o,maxLeft:i,maxTop:n}=b;let s=t.clientX-_.x,u=t.clientY-_.y;s<a?s=a:s>i&&(s=i),u<o?u=o:u>n&&(u=n),p.value=u,h.value=s}function L(){if(!1===c.draggable)return;const e=w.width/2,t=h.value+g.width/2;y.value=!0,t<e?(h.value=b.minLeft,f.value="right"):(h.value=b.maxLeft,f.value="left")}const I=e.computed((()=>{const e={top:p.value+"px",left:h.value+"px",transition:y.value?"all ease 0.3s":"none"};return t.isDef(c.zIndex)&&(e["z-index"]=c.zIndex),`${t.objToStyle(e)};${c.customStyle}`}));function $(){c.disabled||(c.expandable?(d.value=!d.value,l("update:active",d.value)):l("click"))}return e.onMounted((()=>{v&&v.pushToQueue?v.pushToQueue(m):o.pushToQueue(m);const{start:a}=n.useRaf((async()=>{await async function(){const a=e.index.getSystemInfoSync();try{const e=await t.getRect("#trigger",!1,m);g.width=e.width||56,g.height=e.height||56}catch(u){console.log(u)}const{top:o=16,left:i=16,right:n=16,bottom:s=16}=c.gap;w.width=a.windowWidth,w.height=t.isH5?a.windowTop+a.windowHeight:a.windowHeight,b.minTop=t.isH5?a.windowTop+o:o,b.minLeft=i,b.maxLeft=w.width-g.width-n,b.maxTop=w.height-g.height-s}(),x(),r.value=!0}));a()})),e.onBeforeUnmount((()=>{v&&v.removeFromQueue?v.removeFromQueue(m):o.removeFromQueue(m)})),s({open:function(){d.value=!0,l("update:active",!0)},close:function(){d.value=!1,l("update:active",!1)}}),(t,a)=>e.e({a:t.$slots.trigger},t.$slots.trigger?{}:{b:e.p({"custom-class":"wd-fab__icon",name:d.value?t.activeIcon:t.inactiveIcon}),c:e.o($),d:e.p({"custom-class":"wd-fab__trigger",round:!0,type:t.type,disabled:t.disabled})},{e:e.o((()=>{})),f:r.value?"visible":"hidden",g:t.expandable},t.expandable?{h:e.p({"enter-class":`wd-fab__transition-enter--${f.value}`,"enter-active-class":"wd-fab__transition-enter-active","leave-to-class":`wd-fab__transition-leave-to--${f.value}`,"leave-active-class":"wd-fab__transition-leave-active","custom-class":`wd-fab__actions wd-fab__actions--${f.value}`,show:d.value,duration:300})}:{},{i:e.o(j),j:e.o(T),k:e.o(L),l:e.n(`wd-fab ${t.customClass}`),m:e.s(I.value),n:e.o((()=>{}))})}}),r=e._export_sfc(l,[["__scopeId","data-v-4e8307da"]]);wx.createComponent(r);
