"use strict";const e=require("../../../../common/vendor.js"),l=require("../common/util.js"),o=require("../composables/useCell.js"),a=require("../wd-form/types.js"),s=require("../composables/useParent.js"),r=require("../composables/useTranslate.js"),t=require("./types.js");Math||i();const i=()=>"../wd-icon/wd-icon.js",n=e.defineComponent({name:"wd-input",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:t.inputProps,emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","clicksuffixicon","clickprefixicon","click"],setup(t,{emit:i}){const n=t,u=i,c=e.useSlots(),{translate:p}=r.useTranslate("input"),d=e.ref(!1),f=e.ref(!1),m=e.ref(!1),v=e.ref(!1),h=e.ref(function(){const e=function(e){const{maxlength:o}=n;if(l.isDef(o)&&-1!==o&&String(e).length>o)return e.toString().slice(0,o);return e}(n.modelValue);o=e,a=n.modelValue,l.isEqual(String(o),String(a))||u("update:modelValue",e);var o,a;return e}()),x=o.useCell();e.watch((()=>n.focus),(e=>{m.value=e}),{immediate:!0,deep:!0}),e.watch((()=>n.modelValue),(e=>{h.value=l.isDef(e)?String(e):""}));const{parent:b}=s.useParent(a.FORM_KEY),g=e.computed((()=>l.isDef(n.placeholder)?n.placeholder:p("placeholder"))),w=e.computed((()=>{const{disabled:e,readonly:l,clearable:o,clearTrigger:a}=n;return!(!o||l||e||!h.value||!("always"===a||"focus"===n.clearTrigger&&v.value))})),$=e.computed((()=>{const{disabled:e,readonly:o,maxlength:a,showWordLimit:s}=n;return Boolean(!e&&!o&&l.isDef(a)&&a>-1&&s)})),y=e.computed((()=>b&&n.prop&&b.errorMessages&&b.errorMessages[n.prop]?b.errorMessages[n.prop]:"")),_=e.computed((()=>{let e=!1;if(b&&b.props.rules){const l=b.props.rules;for(const o in l)Object.prototype.hasOwnProperty.call(l,o)&&o===n.prop&&Array.isArray(l[o])&&(e=l[o].some((e=>e.required)))}return n.required||n.rules.some((e=>e.required))||e})),I=e.computed((()=>`wd-input  ${n.label||c.label?"is-cell":""} ${n.center?"is-center":""} ${x.border.value?"is-border":""} ${n.size?"is-"+n.size:""} ${n.error?"is-error":""} ${n.disabled?"is-disabled":""}  ${h.value&&String(h.value).length>0?"is-not-empty":""}  ${n.noBorder?"is-no-border":""} ${n.customClass}`)),S=e.computed((()=>`wd-input__label ${n.customLabelClass} ${_.value?"is-required":""}`)),j=e.computed((()=>`wd-input__placeholder  ${n.placeholderClass}`)),q=e.computed((()=>n.labelWidth?l.objToStyle({"min-width":n.labelWidth,"max-width":n.labelWidth}):""));function C(){d.value=!d.value}async function P(){f.value=!0,v.value=!1,h.value="",n.focusWhenClear&&(m.value=!1),await l.pause(),n.focusWhenClear&&(m.value=!0,v.value=!0),u("update:modelValue",h.value),u("clear")}async function k(){await l.pause(150),f.value?f.value=!1:(v.value=!1,u("blur",{value:h.value}))}function V({detail:e}){v.value=!0,u("focus",e)}function T({detail:e}){u("update:modelValue",h.value),u("input",e)}function W({detail:e}){u("keyboardheightchange",e)}function E({detail:e}){u("confirm",e)}function M(){u("clicksuffixicon")}function D(){u("clickprefixicon")}function O(e){u("click",e)}return(l,o)=>e.e({a:l.label||l.$slots.label},l.label||l.$slots.label?e.e({b:l.prefixIcon||l.$slots.prefix},l.prefixIcon||l.$slots.prefix?e.e({c:l.prefixIcon&&!l.$slots.prefix},l.prefixIcon&&!l.$slots.prefix?{d:e.o(D),e:e.p({"custom-class":"wd-input__icon",name:l.prefixIcon})}:{}):{},{f:l.label&&!l.$slots.label},l.label&&!l.$slots.label?{g:e.t(l.label)}:{},{h:e.n(S.value),i:e.s(q.value)}):{},{j:(l.prefixIcon||l.$slots.prefix)&&!l.label},!l.prefixIcon&&!l.$slots.prefix||l.label?{}:e.e({k:l.prefixIcon&&!l.$slots.prefix},l.prefixIcon&&!l.$slots.prefix?{l:e.o(D),m:e.p({"custom-class":"wd-input__icon",name:l.prefixIcon})}:{}),{n:e.n(l.prefixIcon?"wd-input__inner--prefix":""),o:e.n($.value?"wd-input__inner--count":""),p:e.n(l.alignRight?"is-align-right":""),q:e.n(l.customInputClass),r:l.type,s:l.showPassword&&!d.value,t:g.value,v:l.disabled||l.readonly,w:l.maxlength,x:m.value,y:l.confirmType,z:l.confirmHold,A:l.cursor,B:l.cursorSpacing,C:l.placeholderStyle,D:l.selectionStart,E:l.selectionEnd,F:l.adjustPosition,G:l.holdKeyboard,H:l.alwaysEmbed,I:j.value,J:l.ignoreCompositionEvent,K:l.inputmode,L:e.o([e=>h.value=e.detail.value,T]),M:e.o(V),N:e.o(k),O:e.o(E),P:e.o(W),Q:h.value,R:l.readonly},(l.readonly,{}),{S:w.value||l.showPassword||l.suffixIcon||$.value||l.$slots.suffix},w.value||l.showPassword||l.suffixIcon||$.value||l.$slots.suffix?e.e({T:w.value},w.value?{U:e.o(P),V:e.p({"custom-class":"wd-input__clear",name:"error-fill"})}:{},{W:l.showPassword},l.showPassword?{X:e.o(C),Y:e.p({"custom-class":"wd-input__icon",name:d.value?"view":"eye-close"})}:{},{Z:$.value},$.value?{aa:e.t(String(h.value).length),ab:e.n(h.value&&String(h.value).length>0?"wd-input__count-current":""),ac:e.n(String(h.value).length>l.maxlength?"is-error":""),ad:e.t(l.maxlength)}:{},{ae:l.suffixIcon&&!l.$slots.suffix},l.suffixIcon&&!l.$slots.suffix?{af:e.o(M),ag:e.p({"custom-class":"wd-input__icon",name:l.suffixIcon})}:{}):{},{ah:y.value},y.value?{ai:e.t(y.value)}:{},{aj:e.n(I.value),ak:e.s(l.customStyle),al:e.o(O)})}}),u=e._export_sfc(n,[["__scopeId","data-v-0c74dce1"]]);wx.createComponent(u);
