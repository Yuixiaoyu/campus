"use strict";const e=require("../../../../common/vendor.js"),t=require("../common/util.js"),n=require("../composables/useTouch.js"),a=require("./types.js"),i=require("../composables/useChildren.js"),o=require("../composables/useTranslate.js");if(!Array){e.resolveComponent("wd-badge")()}Math||((()=>"../wd-badge/wd-badge.js")+s+d+l)();const s=()=>"../wd-icon/wd-icon.js",d=()=>"../wd-sticky/wd-sticky.js",l=()=>"../wd-sticky-box/wd-sticky-box.js",r=e.defineComponent({name:"wd-tabs",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:a.tabsProps,emits:["change","disabled","click","update:modelValue"],setup(s,{expose:d,emit:l}){const r=".wd-tabs__nav-item",c=s,m=l,{translate:u}=o.useTranslate("tabs"),p=e.reactive({activeIndex:0,lineStyle:"display:none;",useInnerLine:!1,inited:!1,animating:!1,mapShow:!1,scrollLeft:0}),{children:b,linkChildren:w}=i.useChildren(a.TABS_KEY);w({state:p,props:c});const{proxy:h}=e.getCurrentInstance(),v=n.useTouch(),f=e.computed((()=>"always"===c.slidable||b.length>c.slidableNum)),g=e.computed((()=>c.animated?t.objToStyle({left:-100*p.activeIndex+"%","transition-duration":c.duration+"ms","-webkit-transition-duration":c.duration+"ms"}):"")),x=(e,n)=>t.isDef(e.name)?e.name:n,I=(e=0,t=!1,n=!0)=>{0!==b.length&&(e=k(e),b[e].disabled||(p.activeIndex=e,n&&(N(!1===t),$()),function(){if(!p.inited)return;const e=x(b[p.activeIndex],p.activeIndex);e!==c.modelValue&&(m("change",{index:p.activeIndex,name:e}),m("update:modelValue",e))}()))},y=t.debounce(I,100,{leading:!0});function _(){p.mapShow?(p.animating=!1,setTimeout((()=>{p.mapShow=!1}),300)):(p.mapShow=!0,setTimeout((()=>{p.animating=!0}),100))}async function N(e=!0){if(!p.inited)return;const{autoLineWidth:n,lineWidth:a,lineHeight:i}=c;try{const o={};if(t.isDef(a))o.width=t.addUnit(a);else if(n){const e=await t.getRect(".wd-tabs__nav-item-text",!0,h),n=Number(e[p.activeIndex].width);o.width=t.addUnit(n)}t.isDef(i)&&(o.height=t.addUnit(i),o.borderRadius=`calc(${t.addUnit(i)} / 2)`);const s=await t.getRect(r,!0,h),d=s[p.activeIndex];let l=s.slice(0,p.activeIndex).reduce(((e,t)=>e+Number(t.width)),0)+Number(d.width)/2;l&&(o.transform=`translateX(${l}px) translateX(-50%)`,e&&(o.transition="width 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);"),p.useInnerLine=!1,p.lineStyle=t.objToStyle(o))}catch(o){console.error("[wot design] error(wd-tabs): update line style failed",o)}}function $(){p.inited&&Promise.all([t.getRect(r,!0,h),t.getRect(".wd-tabs__nav-container",!1,h)]).then((([e,t])=>{const n=e[p.activeIndex],a=e.slice(0,p.activeIndex).reduce(((e,t)=>e+t.width),0)-(t.width-Number(n.width))/2;a===p.scrollLeft?p.scrollLeft=a+Math.random()/1e4:p.scrollLeft=a}))}function S(e){if(void 0===e)return;const{disabled:t}=b[e],n=x(b[e],e);t?m("disabled",{index:e,name:n}):(p.mapShow&&_(),y(e),m("click",{index:e,name:n}))}function C(e){c.swipeable&&v.touchStart(e)}function L(e){c.swipeable&&v.touchMove(e)}function j(){if(!c.swipeable)return;const{direction:e,deltaX:t,offsetX:n}=v;"horizontal"===e.value&&n.value>=50&&(t.value>0&&0!==p.activeIndex?y(p.activeIndex-1):t.value<0&&p.activeIndex!==b.length-1&&y(p.activeIndex+1))}function k(e){if(t.isNumber(e)&&e>=b.length&&(console.error("[wot design] warning(wd-tabs): the type of tabs' value is Number shouldn't be less than its children"),e=0),t.isString(e)){const t=b.findIndex((t=>t.name===e));e=-1===t?0:t}return e}return e.watch((()=>c.modelValue),(e=>{t.isNumber(e)||t.isString(e)||console.error("[wot design] error(wd-tabs): the type of value should be number or string"),""!==e&&t.isDef(e)||console.error("[wot design] error(wd-tabs): tabs's value cannot be '' null or undefined"),"number"==typeof e&&e<0&&console.error("[wot design] error(wd-tabs): tabs's value cannot be less than zero")}),{immediate:!0,deep:!0}),e.watch((()=>c.modelValue),(e=>{const t=k(e);y(e,!1,t!==p.activeIndex)}),{immediate:!1,deep:!0}),e.watch((()=>b.length),(()=>{p.inited&&e.nextTick$1((()=>{y(c.modelValue)}))})),e.watch((()=>c.slidableNum),(e=>{t.checkNumRange(e,"slidableNum")})),e.watch((()=>c.mapNum),(e=>{t.checkNumRange(e,"mapNum")})),e.onMounted((()=>{p.inited=!0,e.nextTick$1((()=>{I(c.modelValue,!0),p.useInnerLine=!0}))})),d({setActive:y,scrollIntoView:$,updateLineStyle:N}),(t,n)=>e.e({a:t.sticky},t.sticky?e.e({b:e.f(e.unref(b),((n,a,i)=>e.e({a:n.badgeProps},n.badgeProps?{b:e.t(n.title),c:"75ef073c-2-"+i+",75ef073c-1",d:e.p({...n.badgeProps})}:{e:e.t(n.title)},{f:p.activeIndex===a&&p.useInnerLine},(p.activeIndex===a&&p.useInnerLine,{}),{g:e.o((e=>S(a)),a),h:a,i:e.n(`wd-tabs__nav-item  ${p.activeIndex===a?"is-active":""} ${n.disabled?"is-disabled":""}`),j:e.s(p.activeIndex===a?t.color?"color:"+t.color:"":t.inactiveColor?"color:"+t.inactiveColor:"")}))),c:e.s(p.lineStyle),d:f.value,e:p.scrollLeft,f:t.mapNum<e.unref(b).length&&0!==t.mapNum},t.mapNum<e.unref(b).length&&0!==t.mapNum?{g:e.p({name:"arrow-down"}),h:e.n("wd-tabs__map-arrow  "+(p.animating?"is-open":"")),i:e.n("wd-tabs__map-btn  "+(p.animating?"is-open":"")),j:e.o(_),k:e.t(t.mapTitle||e.unref(u)("all")),l:e.s(`${p.mapShow?"":"display:none;"}  ${p.animating?"opacity:1;":""}`),m:e.f(e.unref(b),((n,a,i)=>({a:e.t(n.title),b:e.n(`wd-tabs__map-nav-btn ${p.activeIndex===a?"is-active":""}  ${n.disabled?"is-disabled":""}`),c:e.s(p.activeIndex===a?t.color?"color:"+t.color+";border-color:"+t.color:"":t.inactiveColor?"color:"+t.inactiveColor:""),d:a,e:e.o((e=>S(a)),a)}))),n:e.n("wd-tabs__map-body  "+(p.animating?"is-open":"")),o:e.s(p.mapShow?"":"display:none")}:{},{p:e.p({"offset-top":t.offsetTop}),q:e.n(t.animated?"is-animated":""),r:e.s(g.value),s:e.o(C),t:e.o(L),v:e.o(j),w:e.o(j),x:e.s(`${p.mapShow?"":"display:none;"} ${p.animating?"opacity:1;":""}`),y:e.o(_),z:e.n(`wd-tabs ${t.customClass} ${f.value?"is-slide":""} ${t.mapNum<e.unref(b).length&&0!==t.mapNum?"is-map":""}`),A:e.s(t.customStyle)}):e.e({B:e.f(e.unref(b),((n,a,i)=>e.e({a:n.badgeProps},n.badgeProps?{b:e.t(n.title),c:"75ef073c-4-"+i,d:e.p({"custom-class":"wd-tabs__nav-item-badge",...n.badgeProps})}:{e:e.t(n.title)},{f:p.activeIndex===a&&p.useInnerLine},(p.activeIndex===a&&p.useInnerLine,{}),{g:e.o((e=>S(a)),a),h:a,i:e.n(`wd-tabs__nav-item ${p.activeIndex===a?"is-active":""} ${n.disabled?"is-disabled":""}`),j:e.s(p.activeIndex===a?t.color?"color:"+t.color:"":t.inactiveColor?"color:"+t.inactiveColor:"")}))),C:e.s(p.lineStyle),D:f.value,E:p.scrollLeft,F:t.mapNum<e.unref(b).length&&0!==t.mapNum},t.mapNum<e.unref(b).length&&0!==t.mapNum?{G:e.p({name:"arrow-down"}),H:e.n("wd-tabs__map-arrow "+(p.animating?"is-open":"")),I:e.o(_),J:e.t(t.mapTitle||e.unref(u)("all")),K:e.s(`${p.mapShow?"":"display:none;"}  ${p.animating?"opacity:1;":""}`),L:e.f(e.unref(b),((t,n,a)=>({a:e.t(t.title),b:e.n(`wd-tabs__map-nav-btn ${p.activeIndex===n?"is-active":""}  ${t.disabled?"is-disabled":""}`),c:n,d:e.o((e=>S(n)),n)}))),M:e.n("wd-tabs__map-body "+(p.animating?"is-open":"")),N:e.s(p.mapShow?"":"display:none")}:{},{O:e.n(t.animated?"is-animated":""),P:e.s(g.value),Q:e.o(C),R:e.o(L),S:e.o(j),T:e.o(j),U:e.s(`${p.mapShow?"":"display:none;"}  ${p.animating?"opacity:1":""}`),V:e.o(_),W:e.n(`wd-tabs ${t.customClass} ${f.value?"is-slide":""} ${t.mapNum<e.unref(b).length&&0!==t.mapNum?"is-map":""}`)}))}}),c=e._export_sfc(r,[["__scopeId","data-v-75ef073c"]]);wx.createComponent(c);
