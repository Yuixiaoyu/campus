"use strict";const e=require("../../../../common/vendor.js"),a=require("../common/util.js"),l=require("../composables/useCell.js"),o=require("../wd-form/types.js"),r=require("../composables/useParent.js"),t=require("../composables/useTranslate.js"),s=require("./types.js");Math||u();const u=()=>"../wd-icon/wd-icon.js",i=e.defineComponent({name:"wd-textarea",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:s.textareaProps,emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","linechange","clickprefixicon","click"],setup(s,{emit:u}){const{translate:i}=t.useTranslate("textarea"),n=s,c=u,d=e.useSlots(),p=e.computed((()=>a.isDef(n.placeholder)?n.placeholder:i("placeholder"))),m=e.ref(!1),v=e.ref(!1),f=e.ref(!1),h=e.ref(""),b=l.useCell();e.watch((()=>n.focus),(e=>{v.value=e}),{immediate:!0,deep:!0}),e.watch((()=>n.modelValue),(e=>{h.value=a.isDef(e)?String(e):""}),{immediate:!0,deep:!0});const{parent:x}=r.useParent(o.FORM_KEY),g=e.computed((()=>{const{disabled:e,readonly:a,clearable:l,clearTrigger:o}=n;return!(!l||a||e||!h.value||!("always"===o||"focus"===n.clearTrigger&&f.value))})),$=e.computed((()=>{const{disabled:e,readonly:l,maxlength:o,showWordLimit:r}=n;return Boolean(!e&&!l&&a.isDef(o)&&o>-1&&r)})),w=e.computed((()=>x&&n.prop&&x.errorMessages&&x.errorMessages[n.prop]?x.errorMessages[n.prop]:"")),y=e.computed((()=>{let e=!1;if(x&&x.props.rules){const a=x.props.rules;for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&l===n.prop&&Array.isArray(a[l])&&(e=a[l].some((e=>e.required)))}return n.required||n.rules.some((e=>e.required))||e})),_=e.computed((()=>String(I(n.modelValue)||"").length)),C=e.computed((()=>`wd-textarea   ${n.label||d.label?"is-cell":""} ${n.center?"is-center":""} ${b.border.value?"is-border":""} ${n.size?"is-"+n.size:""} ${n.error?"is-error":""} ${n.disabled?"is-disabled":""} ${n.autoHeight?"is-auto-height":""} ${_.value>0?"is-not-empty":""}  ${n.noBorder?"is-no-border":""} ${n.customClass}`)),j=e.computed((()=>`wd-textarea__label ${n.customLabelClass} ${y.value?"is-required":""}`)),q=e.computed((()=>`wd-textarea__placeholder  ${n.placeholderClass}`)),S=e.computed((()=>`${_.value>0?"wd-textarea__count-current":""} ${_.value>n.maxlength?"is-error":""}`)),T=e.computed((()=>n.labelWidth?a.objToStyle({"min-width":n.labelWidth,"max-width":n.labelWidth}):""));function I(e){const{maxlength:a,showWordLimit:l}=n;return l&&-1!==a&&String(e).length>a?e.toString().substring(0,a):`${e}`}async function W(){m.value=!0,f.value=!1,h.value="",n.focusWhenClear&&(v.value=!1),await a.pause(),n.focusWhenClear&&(v.value=!0,f.value=!0),c("update:modelValue",h.value),c("clear")}async function M({detail:e}){await a.pause(150),m.value?m.value=!1:(f.value=!1,c("blur",{value:h.value,cursor:e.cursor?e.cursor:null}))}function P({detail:e}){f.value=!0,c("focus",e)}function V({detail:e}){h.value=I(h.value),c("update:modelValue",h.value),c("input",e)}function k({detail:e}){c("keyboardheightchange",e)}function B({detail:e}){c("confirm",e)}function D({detail:e}){c("linechange",e)}function H(){c("clickprefixicon")}return e.onBeforeMount((()=>{h.value=I(h.value),c("update:modelValue",h.value)})),(a,l)=>e.e({a:a.label||a.$slots.label},a.label||a.$slots.label?e.e({b:a.prefixIcon||a.$slots.prefix},a.prefixIcon||a.$slots.prefix?e.e({c:a.prefixIcon&&!a.$slots.prefix},a.prefixIcon&&!a.$slots.prefix?{d:e.o(H),e:e.p({"custom-class":"wd-textarea__icon",name:a.prefixIcon})}:{}):{},{f:a.label&&!a.$slots.label},a.label&&!a.$slots.label?{g:e.t(a.label)}:{},{h:e.n(j.value),i:e.s(T.value)}):{},{j:e.n(`wd-textarea__inner ${a.customTextareaClass}`),k:p.value,l:a.disabled||a.readonly,m:a.maxlength,n:v.value,o:a.autoFocus,p:a.placeholderStyle,q:q.value,r:a.autoHeight,s:a.cursorSpacing,t:a.fixed,v:a.cursor,w:a.showConfirmBar,x:a.selectionStart,y:a.selectionEnd,z:a.adjustPosition,A:a.holdKeyboard,B:a.confirmType,C:a.confirmHold,D:a.disableDefaultPadding,E:a.ignoreCompositionEvent,F:a.inputmode,G:e.o([e=>h.value=e.detail.value,V]),H:e.o(P),I:e.o(M),J:e.o(B),K:e.o(D),L:e.o(k),M:h.value,N:w.value},w.value?{O:e.t(w.value)}:{},{P:a.readonly},(a.readonly,{}),{Q:g.value},g.value?{R:e.o(W),S:e.p({"custom-class":"wd-textarea__clear",name:"error-fill"})}:{},{T:$.value},$.value?{U:e.t(_.value),V:e.n(S.value),W:e.t(a.maxlength)}:{},{X:e.n(`wd-textarea__value ${g.value?"is-suffix":""} ${a.customTextareaContainerClass} ${$.value?"is-show-limit":""}`),Y:e.n(C.value),Z:e.s(a.customStyle)})}}),n=e._export_sfc(i,[["__scopeId","data-v-64cc60e3"]]);wx.createComponent(n);
