"use strict";const e=require("../../../../common/vendor.js"),a=require("../common/util.js"),t=require("./types.js"),l=require("../common/AbortablePromise.js"),r=e.defineComponent({name:"wd-transition",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:t.transitionProps,emits:["click","before-enter","enter","before-leave","leave","after-leave","after-enter"],setup(t,{emit:r}){const u=e=>{let a=`${n.enterClass} ${n.enterActiveClass}`,t=`${n.enterToClass} ${n.enterActiveClass}`,l=`${n.leaveClass} ${n.leaveActiveClass}`,r=`${n.leaveToClass} ${n.leaveActiveClass}`;if(Array.isArray(e))for(let u=0;u<e.length;u++)a=`wd-${e[u]}-enter wd-${e[u]}-enter-active ${a}`,t=`wd-${e[u]}-enter-to wd-${e[u]}-enter-active ${t}`,l=`wd-${e[u]}-leave wd-${e[u]}-leave-active ${l}`,r=`wd-${e[u]}-leave-to wd-${e[u]}-leave-active ${r}`;else e&&(a=`wd-${e}-enter wd-${e}-enter-active ${a}`,t=`wd-${e}-enter-to wd-${e}-enter-active ${t}`,l=`wd-${e}-leave wd-${e}-leave-active ${l}`,r=`wd-${e}-leave-to wd-${e}-leave-active ${r}`);return{enter:a,"enter-to":t,leave:l,"leave-to":r}},n=t,v=r,o=e.ref(!1),s=e.ref(!1),i=e.ref(""),c=e.ref(!1),d=e.ref(300),$=e.ref(""),w=e.ref(null),f=e.ref(null),m=e.ref(null),p=e.computed((()=>`-webkit-transition-duration:${d.value}ms;transition-duration:${d.value}ms;${s.value||!n.destroy?"":"display: none;"}${n.customStyle}`)),b=e.computed((()=>`wd-transition ${n.customClass}  ${$.value}`));function y(){v("click")}function C(){w.value=new l.AbortablePromise((async e=>{try{const t=u(n.name),l=a.isObj(n.duration)?n.duration.enter:n.duration;i.value="enter",v("before-enter"),f.value=a.pause(),await f.value,v("enter"),$.value=t.enter,d.value=l,f.value=a.pause(),await f.value,o.value=!0,s.value=!0,f.value=a.pause(),await f.value,f.value=null,c.value=!1,$.value=t["enter-to"],e()}catch(t){}}))}function A(){c.value||(c.value=!0,"leave"===i.value?v("after-leave"):"enter"===i.value&&v("after-enter"),!n.show&&s.value&&(s.value=!1))}return e.onBeforeMount((()=>{n.show&&C()})),e.watch((()=>n.show),(e=>{e?(a.isPromise(w.value)&&w.value.abort(),a.isPromise(f.value)&&f.value.abort(),a.isPromise(m.value)&&m.value.abort(),w.value=null,f.value=null,m.value=null,C()):async function(){if(!w.value)return c.value=!1,A();try{if(await w.value,!s.value)return;const e=u(n.name),t=a.isObj(n.duration)?n.duration.leave:n.duration;i.value="leave",v("before-leave"),d.value=t,m.value=a.pause(),await m.value,v("leave"),$.value=e.leave,m.value=a.pause(),await m.value,c.value=!1,$.value=e["leave-to"],m.value=function(e){return new l.AbortablePromise((a=>{const t=setTimeout((()=>{clearTimeout(t),a()}),e)}))}(d.value),await m.value,m.value=null,A(),w.value=null}catch(e){}}()}),{deep:!0}),(a,t)=>e.e({a:!a.lazyRender||o.value},!a.lazyRender||o.value?{b:e.n(b.value),c:e.s(p.value),d:e.o(A),e:e.o(y)}:{})}}),u=e._export_sfc(r,[["__scopeId","data-v-7e1f1ea4"]]);wx.createComponent(u);
