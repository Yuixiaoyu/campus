"use strict";const e=require("../../../../common/vendor.js"),i=require("../common/util.js");function t(e){if(i.isArray(e.tempFiles)){const i=[];return e.tempFiles.forEach((async e=>{i.push({path:e.path||"",name:e.name||"",size:e.size,type:"image",thumb:e.path||""})})),i}return[{path:e.tempFiles.path||"",name:e.tempFiles.name||"",size:e.tempFiles.size,type:"image",thumb:e.tempFiles.path||""}]}exports.chooseFile=function({multiple:i,sizeType:a,sourceType:s,maxCount:m,accept:c,compressed:o,maxDuration:n,camera:p}){return new Promise(((u,r)=>{switch(c){case"image":e.index.chooseImage({count:i?Math.min(m,9):1,sizeType:a,sourceType:s,success:e=>u(t(e)),fail:e=>{r(e)}});break;case"video":e.index.chooseVideo({sourceType:s,compressed:o,maxDuration:n,camera:p,success:e=>{u(function(e){return[{path:e.tempFilePath||e.filePath||"",name:e.name||"",size:e.size,type:"video",thumb:e.thumbTempFilePath||"",duration:e.duration}]}(e))},fail:r});break;case"media":e.index.chooseMedia({count:i?Math.min(m,9):1,sourceType:s,sizeType:a,camera:p,maxDuration:n,success:e=>u(function(e){return e.tempFiles.map((e=>({type:e.fileType,path:e.tempFilePath,thumb:"video"===e.fileType?e.thumbTempFilePath:e.tempFilePath,size:e.size,duration:e.duration})))}(e)),fail:r});break;case"file":case"all":e.index.chooseMessageFile({count:i?Math.min(m,100):1,type:c,success:e=>u(e.tempFiles),fail:r});break;default:e.index.chooseImage({count:i?Math.min(m,9):1,sizeType:a,sourceType:s,success:e=>u(t(e)),fail:r})}}))};
