{"remainingRequest":"G:\\Code\\campus\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\Code\\campus\\vue-admin-template\\src\\views\\activity\\index.vue?vue&type=style&index=0&id=99941528&scoped=true&lang=css","dependencies":[{"path":"G:\\Code\\campus\\vue-admin-template\\src\\views\\activity\\index.vue","mtime":1742645775850},{"path":"G:\\Code\\campus\\vue-admin-template\\node_modules\\css-loader\\dist\\cjs.js","mtime":1742551615470},{"path":"G:\\Code\\campus\\vue-admin-template\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1742551617337},{"path":"G:\\Code\\campus\\vue-admin-template\\node_modules\\postcss-loader\\src\\index.js","mtime":1742551616254},{"path":"G:\\Code\\campus\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742551614966},{"path":"G:\\Code\\campus\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1742551616768}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5maWx0ZXItY29udGFpbmVyIHsKICBwYWRkaW5nLWJvdHRvbTogMTBweDsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgZ2FwOiAxMHB4Owp9Ci9kZWVwLyAuZWwtdGFibGVfX2ZpeGVkLXJpZ2h0ewogIHotaW5kZXg6IDEgIWltcG9ydGFudDsKfQovZGVlcC8gLmVsLXRhYmxlX19maXhlZDo6YmVmb3JlewogIHotaW5kZXg6IDEgIWltcG9ydGFudDsKfQoKLmNsdWItbWVudSB7CiAgYm9yZGVyLXJpZ2h0OiBub25lOwogIGhlaWdodDogY2FsYygxMDB2aCAtIDIwMHB4KTsKICBvdmVyZmxvdy15OiBhdXRvOwp9CgouZWwtZGlhbG9nX19ib2R5IHsKICBwYWRkaW5nOiAyMHB4IDQwcHg7Cn0KCi51cGxvYWQtdGV4dCB7CiAgZm9udC1zaXplOiAxMnB4OwogIGNvbG9yOiAjNjA2MjY2OwogIG1hcmdpbi10b3A6IDEwcHg7Cn0KCi5lbC1jaGVja2JveC1ncm91cCB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgyLCAxZnIpOwogIGdhcDogMTBweDsKfQoKLmF2YXRhci11cGxvYWRlciB7CiAgYm9yZGVyOiAxcHggZGFzaGVkICNkOWQ5ZDk7CiAgYm9yZGVyLXJhZGl1czogNnB4OwogIGN1cnNvcjogcG9pbnRlcjsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKICB3aWR0aDogMTc4cHg7Cn0KCi5hdmF0YXItdXBsb2FkZXI6aG92ZXIgewogIGJvcmRlci1jb2xvcjogIzQwOUVGRjsKfQoKLmF2YXRhci11cGxvYWRlci1pY29uIHsKICBmb250LXNpemU6IDI4cHg7CiAgY29sb3I6ICM4YzkzOWQ7CiAgd2lkdGg6IDE3OHB4OwogIGhlaWdodDogMTc4cHg7CiAgbGluZS1oZWlnaHQ6IDE3OHB4OwogIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKLmF2YXRhciB7CiAgd2lkdGg6IDE3OHB4OwogIGhlaWdodDogMTc4cHg7CiAgZGlzcGxheTogYmxvY2s7Cn0KCi5wYWdpbmF0aW9uLWNvbnRhaW5lciB7CiAgcGFkZGluZzogMzJweCAxNnB4OwogIHRleHQtYWxpZ246IHJpZ2h0Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8jBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/activity","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-row :gutter=\"24\">\n      <!-- 左侧社团分类列表 -->\n      <el-col :span=\"4\">\n        <el-card class=\"box-card\" style=\"height: calc(100vh - 120px);\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>社团分类</span>\n          </div>\n          <el-menu default-active=\"1\" class=\"club-menu\">\n            <!-- 体育类社团 -->\n            <el-submenu index=\"1\">\n              <template slot=\"title\">\n                <i class=\"el-icon-basketball\"></i>\n                <span>体育类社团</span>\n              </template>\n              <el-menu-item v-for=\"(club, index) in sportsClubs\" \n                :key=\"'sports' + index\" \n                :index=\"'1-' + index\"\n              >\n                {{ club }}\n              </el-menu-item>\n            </el-submenu>\n\n            <!-- 服务类社团 -->\n            <el-submenu index=\"2\">\n              <template slot=\"title\">\n                <i class=\"el-icon-service\"></i>\n                <span>服务类社团</span>\n              </template>\n              <el-menu-item v-for=\"(club, index) in serviceClubs\" \n                :key=\"'service' + index\" \n                :index=\"'2-' + index\"\n              >\n                {{ club }}\n              </el-menu-item>\n            </el-submenu>\n\n            <!-- 学术类社团 -->\n            <el-submenu index=\"3\">\n              <template slot=\"title\">\n                <i class=\"el-icon-reading\"></i>\n                <span>学术类社团</span>\n              </template>\n              <el-menu-item v-for=\"(club, index) in academicClubs\" \n                :key=\"'academic' + index\" \n                :index=\"'3-' + index\"\n              >\n                {{ club }}\n              </el-menu-item>\n            </el-submenu>\n\n            <!-- 艺术类社团 -->\n            <el-submenu index=\"4\">\n              <template slot=\"title\">\n                <i class=\"el-icon-picture\"></i>\n                <span>艺术类社团</span>\n              </template>\n              <el-menu-item v-for=\"(club, index) in artClubs\" \n                :key=\"'art' + index\" \n                :index=\"'4-' + index\"\n              >\n                {{ club }}\n              </el-menu-item>\n            </el-submenu>\n          </el-menu>\n        </el-card>\n      </el-col>\n\n      <!-- 右侧内容区 -->\n      <el-col :span=\"20\">\n        <el-card class=\"box-card\">\n          <!-- 顶部搜索和操作区 -->\n          <div class=\"filter-container\">\n            <el-input\n              v-model=\"listQuery.title\"\n              placeholder=\"活动标题\"\n              style=\"width: 200px;\"\n              class=\"filter-item\"\n            />\n            <el-input\n              v-model=\"listQuery.profile\"\n              placeholder=\"活动简介\"\n              style=\"width: 200px;\"\n              class=\"filter-item\"\n            />\n            <el-select v-model=\"listQuery.category\" placeholder=\"活动类别\" class=\"filter-item\" style=\"width: 150px;\">\n              <el-option label=\"全部\" value=\"\" />\n              <el-option v-for=\"type in activityTypes\" :key=\"type\" :label=\"type\" :value=\"type\" />\n            </el-select>\n            <el-input\n              v-model=\"listQuery.organizer\"\n              placeholder=\"组织名称\"\n              style=\"width: 200px;\"\n              class=\"filter-item\"\n            />\n            <el-input\n              v-model=\"listQuery.targetUsers\"\n              placeholder=\"活动对象\"\n              style=\"width: 150px;\"\n              class=\"filter-item\"\n            />\n            <el-button class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handleSearch\">\n              搜索\n            </el-button>\n            <el-button class=\"filter-item\" type=\"success\" icon=\"el-icon-plus\" @click=\"handleCreate\">\n              发布活动\n            </el-button>\n          </div>\n\n          <!-- 活动列表 -->\n          <el-table \n            v-loading=\"listLoading\"\n            :data=\"activityList\" \n            style=\"width: 100%; margin-top: 20px; height: calc(100vh - 290px)\"\n            :height=\"'calc(100vh - 290px)'\"\n            element-loading-text=\"加载中...\"\n            border\n            stripe\n            highlight-current-row\n          >\n            <el-table-column label=\"活动封面\" width=\"120\" fixed>\n              <template slot-scope=\"{row}\">\n                <el-image\n                  style=\"width: 80px; height: 80px\"\n                  :src=\"row.coverPicture\"\n                  fit=\"cover\"\n                  :preview-src-list=\"[row.coverPicture]\"\n                >\n                  <div slot=\"error\" class=\"image-slot\">\n                    <i class=\"el-icon-picture-outline\"></i>\n                  </div>\n                </el-image>\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"title\" label=\"活动标题\" min-width=\"150\" fixed />\n            <el-table-column prop=\"profile\" label=\"活动简介\" min-width=\"200\">\n              <template slot-scope=\"{row}\">\n                <el-tooltip \n                  class=\"item\" \n                  effect=\"dark\" \n                  :content=\"row.profile || '暂无简介'\" \n                  placement=\"top-start\"\n                >\n                  <span>{{ row.profile | ellipsis }}</span>\n                </el-tooltip>\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"category\" label=\"活动类别\" width=\"100\" />\n            <el-table-column prop=\"organizers\" label=\"主办单位\" width=\"150\" />\n            <el-table-column prop=\"position\" label=\"活动地点\" width=\"150\" />\n            <el-table-column label=\"报名情况\" width=\"120\" align=\"center\">\n              <template slot-scope=\"{row}\">\n                {{ row.currentSignups }}/{{ row.maxSignups }}\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"targetUsers\" label=\"活动对象\" width=\"120\" />\n            <el-table-column prop=\"userId\" label=\"创建人ID\" width=\"100\" align=\"center\" />\n            <el-table-column prop=\"hits\" label=\"点击量\" width=\"80\" align=\"center\" />\n            <el-table-column prop=\"status\" label=\"状态\" width=\"100\" align=\"center\">\n              <template slot-scope=\"{row}\">\n                <el-tag :type=\"row.status === 1 ? 'success' : 'info'\">\n                  {{ row.status === 1 ? '进行中' : '已结束' }}\n                </el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"startTime\" label=\"开始时间\" width=\"160\" align=\"center\" />\n            <el-table-column prop=\"endTime\" label=\"结束时间\" width=\"160\" align=\"center\" />\n            <el-table-column label=\"操作\" width=\"150\" fixed=\"right\" align=\"center\">\n              <template slot-scope=\"{row}\">\n                <el-button type=\"text\" @click=\"handleEdit(row)\">编辑</el-button>\n                <el-button type=\"text\" @click=\"handleDelete(row)\">删除</el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n\n          <!-- 分页 -->\n          <div class=\"pagination-container\">\n            <el-pagination\n              background\n              @size-change=\"handleSizeChange\"\n              @current-change=\"handleCurrentChange\"\n              :current-page=\"listQuery.current\"\n              :page-sizes=\"[10, 20, 30, 50]\"\n              :page-size=\"listQuery.pageSize\"\n              layout=\"total, sizes, prev, pager, next, jumper\"\n              :total=\"total\">\n            </el-pagination>\n          </div>\n        </el-card>\n      </el-col>\n    </el-row>\n\n    <!-- 活动发布/编辑对话框 -->\n    <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogVisible\" width=\"50%\" >\n      <el-form ref=\"activityForm\" :model=\"activityForm\" :rules=\"rules\" label-width=\"100px\">\n        <el-form-item label=\"活动标题\" prop=\"title\">\n          <el-input v-model=\"activityForm.title\" placeholder=\"请输入活动标题\" style=\"width: 90%\" />\n        </el-form-item>\n        <el-form-item label=\"活动简介\" prop=\"description\">\n          <el-input \n            type=\"textarea\" \n            v-model=\"activityForm.profile\" \n            rows=\"4\" \n            placeholder=\"请输入活动简介(选填)\"\n            style=\"width: 90%\" \n          />\n        </el-form-item>\n        <el-form-item label=\"活动类别\" prop=\"category\" required>\n          <el-select v-model=\"activityForm.category\" placeholder=\"请选择活动类别\" style=\"width: 90%\">\n            <el-option v-for=\"type in activityTypes\" :key=\"type\" :label=\"type\" :value=\"type\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"发布人ID\" prop=\"publisherId\">\n          <el-input v-model=\"activityForm.userId\" disabled style=\"width: 90%\" />\n        </el-form-item>\n        <el-form-item label=\"封面图片\" prop=\"coverPicture\" required>\n          <el-upload\n            class=\"avatar-uploader\"\n            action=\"/api/upload/fileList\"\n            :show-file-list=\"false\"\n            :on-success=\"handleImageSuccess\"\n            :before-upload=\"beforeImageUpload\">\n            <img v-if=\"activityForm.coverPicture\" :src=\"activityForm.coverPicture\" class=\"avatar\">\n            <div v-else class=\"avatar-uploader-icon\">\n              <i class=\"el-icon-plus\"></i>\n              <div class=\"upload-text\">点击上传封面图片</div>\n            </div>\n          </el-upload>\n        </el-form-item>\n        <el-form-item label=\"主办单位\" prop=\"organizers\" required>\n          <el-input v-model=\"activityForm.organizers\" placeholder=\"请输入主办单位名称\" style=\"width: 90%\" />\n        </el-form-item>\n        <el-form-item label=\"活动地点\" prop=\"position\" required>\n          <el-input v-model=\"activityForm.position\" placeholder=\"请输入活动具体地点\" style=\"width: 90%\" />\n        </el-form-item>\n        <el-form-item label=\"最大报名人数\" label-width=\"120px\" prop=\"maxSignups\" required>\n          <el-input-number \n            v-model=\"activityForm.maxSignups\"\n            :min=\"1\" \n            :max=\"1000\"\n            placeholder=\"请输入最大报名人数\"\n            style=\"width: 220px\"\n          />\n        </el-form-item>\n        <el-form-item label=\"活动对象\" prop=\"targetUsers\" required>\n          <el-select v-model=\"activityForm.targetUsers\" placeholder=\"请选择活动对象\" style=\"width: 90%\">\n            <el-option v-for=\"target in targetAudienceOptions\" \n              :key=\"target\" \n              :value=\"target\">\n              {{ target }}\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"活动时间\" prop=\"timeRange\">\n          <el-date-picker\n            v-model=\"activityForm.timeRange\"\n            type=\"datetimerange\"\n            range-separator=\"至\"\n            start-placeholder=\"开始时间\"\n            end-placeholder=\"结束时间\"\n            style=\"width: 90%\"\n          />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"handleSubmit\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { publishActivityUsingPost, getActivityListUsingPost, updateActivityUsingPost, removeActivityUsingPost } from '@/api/activityController'\nimport { mapState } from 'vuex'\n\nexport default {\n  name: 'Activity',\n  filters: {\n    // 文本超过20个字符显示省略号\n    ellipsis(value) {\n      if (!value) return ''\n      if (value.length > 20) {\n        return value.slice(0, 20) + '...'\n      }\n      return value\n    }\n  },\n  computed: {\n    ...mapState({\n      userInfo: state => state.user.userInfo\n    })\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      dialogTitle: '发布活动',\n      activityList: [], // 活动列表数据\n      total: 0,\n      listLoading: true,\n      listQuery: {\n        current: 1,\n        pageSize: 10,\n        title: undefined,\n        type: undefined,\n        profile: undefined,\n        organizer: undefined,\n        targetUsers: undefined,\n        startTime: undefined,\n        endTime: undefined\n      },\n      \n      // 活动类别选项\n      activityTypes: ['体育', '学术', '艺术', '服务'],\n      \n      // 活动对象选项\n      targetAudienceOptions: ['全体师生', '本科生', '研究生', '教职工'],\n      \n      // 表单数据\n      activityForm: {\n        id: undefined,\n        title: '',\n        profile: '',\n        category: '',\n        userId: '',\n        coverPicture: '',\n        organizers: '',\n        position: '',\n        maxSignups: 100,\n        targetUsers: '',\n        timeRange: []\n      },\n      \n      // 表单验证规则\n      rules: {\n        title: [{ required: true, message: '请输入活动标题', trigger: 'blur' }],\n        category: [{ required: true, message: '请选择活动类别', trigger: 'change' }],\n        organizers: [{ required: true, message: '请输入主办单位名称', trigger: 'blur' }],\n        position: [{ required: true, message: '请输入活动具体地点', trigger: 'blur' }],\n        maxSignups: [\n          { required: true, message: '请输入最大报名人数', trigger: 'blur' },\n          { type: 'number', min: 1, message: '报名人数必须大于0', trigger: 'blur' }\n        ],\n        timeRange: [{ required: true, message: '请选择活动时间', trigger: 'change' }],\n        targetUsers: [{ required: true, message: '请选择活动对象', trigger: 'change' }],\n        coverPicture: [{ required: true, message: '请上传活动封面图片', trigger: 'change' }]\n      },\n      \n      // 原有的社团数据保持不变\n      sportsClubs: [\n        '瑜伽协会', '译苑棋社', '篮球俱乐部', '武术协会', \n        '电子竞技协会', 'SRT沙尘暴滑轮协会', '羽毛球协会',\n        '高尔夫俱乐部', '乒乓球协会', '网球协会'\n      ],\n      serviceClubs: [\n        '图书馆学生管理委员会', '国旗班', '爱心协会',\n        '希冀环保协会', '红十字会'\n      ],\n      academicClubs: [\n        '红杉科技社', '英语口语尖兵队', '行知调研社', '经贸协会',\n        '旅游协会', '辩论协会', '新外语学社', '创业联合协会',\n        '大学生心理协会', '西班牙口语尖兵队', '韩语口语尖兵队',\n        '日语口语尖兵队'\n      ],\n      artClubs: [\n        '国学研习会', 'Mighty Force街舞研习社', '雏凤诗社',\n        'E-LEVEL主持达人队', '动感漫研社', '书画协会',\n        '冉飞研习剧社', '桃李文学通讯社', '摄影协会',\n        '流行音乐文化社', '魔术协会', '蓝天艺术社'\n      ]\n    }\n  },\n  \n  created() {\n    // 在组件创建时设置发布者ID\n    if (this.userInfo) {\n      this.activityForm.userId = this.userInfo.id\n    }\n    // 获取活动列表\n    this.getList()\n  },\n  \n  watch: {\n    // 监听用户信息变化\n    userInfo: {\n      handler(newVal) {\n        if (newVal) {\n          this.activityForm.userId = newVal.id\n        }\n      },\n      immediate: true\n    }\n  },\n  \n  methods: {\n    // 获取活动列表数据\n    async getList() {\n      this.listLoading = true\n      try {\n        // 处理查询参数\n        const query = {\n          ...this.listQuery\n        }\n        \n        const response = await getActivityListUsingPost(query)\n        this.activityList = response.data.records\n        this.total = response.data.total\n      } catch (error) {\n        console.error('获取活动列表失败:', error)\n        this.$message.error('获取活动列表失败')\n      } finally {\n        this.listLoading = false\n      }\n    },\n\n    // 处理搜索\n    handleSearch() {\n      this.listQuery.current = 1\n      this.getList()\n    },\n    \n    // 处理创建活动\n    handleCreate() {\n      this.dialogTitle = '发布活动'\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        this.$refs.activityForm.resetFields()\n        // 重置表单数据\n        this.activityForm = {\n          id: undefined,\n          title: '',\n          profile: '',\n          category: '',\n          userId: this.userInfo ? this.userInfo.id : '',\n          coverPicture: '',\n          organizers: '',\n          position: '',\n          maxSignups: 100,\n          targetUsers: '',\n          timeRange: []\n        }\n      })\n    },\n    \n    // 处理图片上传成功\n    handleImageSuccess(res, file) {\n      if (res.code === 200 && res.data && res.data.length > 0) {\n        // 使用服务器返回的图片URL\n        this.activityForm.coverPicture = res.data[0]\n      } else {\n        this.$message.error('图片上传失败')\n      }\n    },\n    \n    // 图片上传前的验证\n    beforeImageUpload(file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png'\n      const isLt2M = file.size / 1024 / 1024 < 2\n\n      if (!isJPG) {\n        this.$message.error('上传图片只能是 JPG/PNG 格式!')\n      }\n      if (!isLt2M) {\n        this.$message.error('上传图片大小不能超过 2MB!')\n      }\n      return isJPG && isLt2M\n    },\n    \n    // 处理表单提交\n    handleSubmit() {\n      this.$refs.activityForm.validate(async (valid) => {\n        if (valid) {\n          try {\n            // 格式化日期\n            const formatDate = (date) => {\n              const pad = (num) => (num < 10 ? `0${num}` : num)\n              const year = date.getFullYear()\n              const month = pad(date.getMonth() + 1)\n              const day = pad(date.getDate())\n              const hours = pad(date.getHours())\n              const minutes = pad(date.getMinutes())\n              const seconds = pad(date.getSeconds())\n              return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`\n            }\n\n            const submitData = {\n              id: this.activityForm.id,\n              ...this.activityForm,\n              startTime: formatDate(new Date(this.activityForm.timeRange[0])),\n              endTime: formatDate(new Date(this.activityForm.timeRange[1]))\n            }\n            delete submitData.timeRange\n            \n            // 根据是否有id判断是新增还是编辑\n            if (submitData.id) {\n              await updateActivityUsingPost(submitData)\n              this.$message.success('活动更新成功')\n            } else {\n              delete submitData.id\n              await publishActivityUsingPost(submitData)\n              this.$message.success('活动发布成功')\n            }\n            this.dialogVisible = false\n            // 刷新活动列表\n            this.getList()\n          } catch (error) {\n            const action = this.activityForm.id ? '更新' : '发布'\n            this.$message.error(`活动${action}失败`)\n          }\n        }\n      })\n    },\n\n    // 处理每页条数变化\n    handleSizeChange(val) {\n      this.listQuery.pageSize = val\n      this.getList()\n    },\n\n    // 处理页码变化\n    handleCurrentChange(val) {\n      this.listQuery.current = val\n      this.getList()\n    },\n\n    // 处理编辑活动\n    handleEdit(row) {\n      this.dialogTitle = '编辑活动'\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        // 将时间字符串转换为日期对象数组\n        const timeRange = [new Date(row.startTime), new Date(row.endTime)]\n\n        // 复制活动数据并添加时间范围\n        this.activityForm = {\n          ...row,\n          timeRange\n        }\n        console.log('编辑表单数据:', this.activityForm)\n      })\n    },\n\n    // 处理删除活动\n    handleDelete(row) {\n      this.$confirm('确认删除该活动?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(async () => {\n        try {\n          await removeActivityUsingPost({ id: row.id })\n          this.$message({\n            type: 'success',\n            message: '删除成功!'\n          })\n          // 刷新活动列表\n          this.getList()\n        } catch (error) {\n          this.$message.error('删除失败')\n        }\n      }).catch(() => {\n        // 取消删除时的处理\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    }\n  }\n}\n</script> \n\n<style scoped>\n.filter-container {\n  padding-bottom: 10px;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n/deep/ .el-table__fixed-right{\n  z-index: 1 !important;\n}\n/deep/ .el-table__fixed::before{\n  z-index: 1 !important;\n}\n\n.club-menu {\n  border-right: none;\n  height: calc(100vh - 200px);\n  overflow-y: auto;\n}\n\n.el-dialog__body {\n  padding: 20px 40px;\n}\n\n.upload-text {\n  font-size: 12px;\n  color: #606266;\n  margin-top: 10px;\n}\n\n.el-checkbox-group {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 10px;\n}\n\n.avatar-uploader {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n  width: 178px;\n}\n\n.avatar-uploader:hover {\n  border-color: #409EFF;\n}\n\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n\n.pagination-container {\n  padding: 32px 16px;\n  text-align: right;\n}\n</style> "]}]}